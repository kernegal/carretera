<!doctype html>

<html lang="en">
	<head>
		<title>Treehouse Logo in three.js. Never!</title>
		<meta charset="utf-8">
	</head>
	<body style="margin: 0;">

		<script src="js/three.min.js"></script>
		<script src="js/controls/OrbitControls.js"></script>
		<script src="js/libs/stats.min.js"></script>
		<script src="js/controls/FirstPersonControls.js"></script>

        <script> 
            function genCircuit(width, height, displace,roughness){
                var points = [],power=Math.pow(2,Math.ceil(Math.log(width)/Math.log(2)));
                points[0]=points[power]=height/2+(Math.random()*displace*2)-displace;
                var cuarters=power/2;
                points[cuarters]=height/2+(Math.random()*displace*2)-displace;
                displace*=roughness;
                
                for(var i=2;i<power;i*=2){
                    for(var j=(power/i)/2;j<power;j+=power/i){
                        points[j]=((points[j- (power/i)/2]+points[j+(power/i)/2])/2);
                        points[j]+=(Math.random()*displace*2)-displace;
                    }
                    displace*=roughness;
                }
                return points;
            }
            function mapToCircle(points){
                var circlePoints=[];
                var delta=2*Math.PI/points.length;
                var cosDelta=Math.cos(delta);
                var sinDelta=Math.sin(delta);
                var unitVectorX=0;
                var unitVectorY=1;
                var i=0;
                for(var angle=0;angle<2*Math.PI;angle+=delta){
                    
                    circlePoints[i]=new THREE.Vector3(unitVectorX*points[i],unitVectorY*points[i],0);
                    unitVectorX=unitVectorX*cosDelta+unitVectorY*sinDelta;
                    unitVectorX=-unitVectorX*sinDelta+unitVectorY*cosDelta;
                    i++;
                }
                return circlePoints;
            }
        </script>
        
		<script>
			var scene = new THREE.Scene();
			var camera = new THREE.PerspectiveCamera( 75, window.innerWidth / window.innerHeight, 0.1, 1000 );
			stats = new Stats();
			stats.domElement.style.position = 'absolute';
			stats.domElement.style.top = '0px';
			document.body.appendChild(stats.domElement);
			
			/*controls = new THREE.FirstPersonControls( camera );
			controls.movementSpeed = 10;
			controls.lookSpeed = 0.1;*/
			
			var clock = new THREE.Clock();
			
			var renderer = new THREE.WebGLRenderer();
			renderer.setSize( window.innerWidth, window.innerHeight );
			document.body.appendChild( renderer.domElement );
			
			/*var ambientLight = new THREE.AmbientLight(0x111111);
			scene.add(ambientLight);
			
			var light = new THREE.PointLight(0xffffff);
			light.position.set(-10,20,10);
			scene.add(light);
			
			var geometry = new THREE.BoxGeometry( 1, 1, 1 );
			var material = new THREE.MeshLambertMaterial( { color: 0x00ff00 } );
			var cube = new THREE.Mesh( geometry, material );
			geometry.dynamic = true;
            cube.position.set(0,0,-11);
			scene.add( cube );
			
			var geometry = new THREE.PlaneGeometry(60, 60, 199, 199);
			var material = new THREE.MeshPhongMaterial({
				color: 0xdddddd, 
				wireframe: true
			});
			var plane = new THREE.Mesh(geometry, material);
			plane.rotation.x=-Math.PI/2;
            plane.geometry.vertices[10].z=50
			scene.add(plane);*/
            var width=80;
            var height=10;
            var points=genCircuit(width, height, 30,0.3);
            var pointsCarretera=mapToCircle(points);
			var material = new THREE.LineBasicMaterial({
				color: 0xdddddd
			});
            var geometry=new THREE.Geometry();
            for(var i=0; i<pointsCarretera.length;i++){
                geometry.vertices.push(pointsCarretera[i]);
            }
            var line=new THREE.Line(geometry,material);
            line.position.set(-60,0,-60);
            scene.add(line);
            
            var material2 = new THREE.LineBasicMaterial({
				color: 0xdd0000
			});
            var geometry2=new THREE.Geometry();
            for(var i=0; i<points.length;i++){
                geometry.vertices.push(new THREE.Vector3(i,points[i],0);
            }
            var line2=new THREE.Line(geometry,material);
            line2.position.set(-60,0,-60);
            scene2.add(line);
            
			camera.position.x = -30;
			camera.position.y =1;
			function render() {
				//cube.rotation.x += 0.1;
				//cube.rotation.y += 0.1;
			
				//controls.update( clock.getDelta() );
				requestAnimationFrame( render );
				renderer.render( scene, camera ); 
				stats.update();
			}
			render();
		</script>

	</body>
</html>
